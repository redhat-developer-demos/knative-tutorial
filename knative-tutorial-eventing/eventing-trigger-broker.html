<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Knative Tutorial :: Knative Tutorial</title>
    <link rel="canonical" href="https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial-eventing/eventing-trigger-broker.html">
    <meta name="generator" content="Antora 2.2.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-developer-demos.github.io/knative-tutorial">Knative Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="knative-tutorial-eventing" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="eventing.html#eventing-prerequisite">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="eventing-src-to-sink.html">Source to Sink</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-source">Event Source</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-sink-service">Sink Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-create-event-source">Create Event Source</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-verify-event-source">Verify</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-see-what-you-have-deployed">See What You Have Deployed</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="eventing-src-to-sink.html#eventing-cleanup">Cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="channel-and-subscribers.html">Channel and Subscribers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="channel-and-subscribers.html#eventing-channel">Channel</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-create-event-channel">Create Event Channel</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-verify-event-channel">Verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="channel-and-subscribers.html#eventing-source">Event Source</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-create-event-source">Create Event Source</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-verify-event-source">Verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="channel-and-subscribers.html#eventing-subscriber">Event Subscriber</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-create-subscriber">Create Event Subscriber</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-verify-subscriber">Verify</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-see-what-you-have-deployed">See What You Have Deployed</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="channel-and-subscribers.html#eventing-cleanup">Cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="eventing-trigger-broker.html">Brokers and Triggers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#events-triggers-brokers">Events, Triggers and Brokers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#broker">Broker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#eventing-service">Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#eventing-event-source">Event Source</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#eventing-trigger">Trigger</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#eventing-trigger-verification">Verification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#eventing-cleanup">Cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="eventing.html#eventing-watch-logs">Watching Logs</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../knative-tutorial/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Knative Eventing</a></li>
    <li><a href="eventing-trigger-broker.html">Brokers and Triggers</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-developer-demos/knative-tutorial-module-eventing/edit/release/v0.14.x/modules/ROOT/pages/eventing-trigger-broker.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Knative Tutorial</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Use the Knative Eventing <code>Broker</code> and <code>Trigger</code> Custom Resources to allow for <a href="https://cloudevents.io/">CloudEvent</a> attribute filtering.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="broker"><a class="anchor" href="#broker"></a>Broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By labeling <code>knativetutorial</code> namespace with <code>knative-eventing-injection=enabled</code> as shown below, will make Knative Eventing to deploy a default Knative Eventing Broker and its related Ingress :</p>
</div>
<div id="label-namespace-for-default-broker" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl label namespace knativetutorial knative-eventing-injection=enabled</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that the default broker is running:</p>
</div>
<div id="watch-ns-for-broker" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl --namespace knativetutorial get broker</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running command above should show an output like:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME     READY REASON URL                                                    AGE
default  True         http://default-broker.knativetutorial.svc.cluster.local   22s</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will also start two additional pods namely <code>default-broker-filter</code> and <code>default-broker-ingress</code> :</p>
</div>
<div id="watch-ns-for-broker-pods" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running command above should show the following pods in knativetutorial:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                         READY STATUS      AGE
default-broker-filter-c6654bccf-qb272        1/1   Running     18s
default-broker-ingress-7479966dc7-99xvm      1/1   Running     18s</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="eventing-service"><a class="anchor" href="#eventing-service"></a>Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now, that you have the broker configured, you need to create the sinks <code>eventingaloha</code> and <code>eventingbonjour</code>, which will receive the filtered events.</p>
</div>
<div class="listingblock">
<div class="title"><a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/eventing-aloha-sink.yaml">eventing-aloha-sink.yaml</a></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: eventingaloha
spec:
  template:
    metadata:
      name: eventingaloha-v1
      annotations:
        autoscaling.knative.dev/target: "1"
    spec:
      containers:
      - image: quay.io/rhdevelopers/eventinghello:0.0.2</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/eventing-bonjour-sink.yaml">eventing-bonjour-sink.yaml</a></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: eventingbonjour
spec:
  template:
    metadata:
      name: eventingbonjour-v1
      annotations:
        autoscaling.knative.dev/target: "1"
    spec:
      containers:
      - image: quay.io/rhdevelopers/eventinghello:0.0.2</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The image being used by both of these services is identical.  However, the difference in name <code>aloha</code> vs <code>bonjour</code> will make obvious which one is receiving a particular event.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="eventing-deploy-service"><a class="anchor" href="#eventing-deploy-service"></a>Deploy Service</h3>
<div class="paragraph">
<p>Run the following commands to deploy the <code>eventingaloha</code> and <code>eventingbonjour</code> services:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n knativetutorial -f <a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/eventing-aloha-sink.yaml">eventing-aloha-sink.yaml</a></code></pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n knativetutorial -f <a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/eventing-bonjour-sink.yaml">eventing-bonjour-sink.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait approximately 60 seconds for <code>eventingaloha</code> and <code>eventingbonjour</code> to terminate, scale-down to zero before proceeding.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="eventing-trigger"><a class="anchor" href="#eventing-trigger"></a>Trigger</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now create the the trigger for <code>eventingaloha</code> that will associate the filtered events to a service:</p>
</div>
<div class="listingblock">
<div class="title"><a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/trigger-helloaloha.yaml">trigger-helloaloha.yaml</a></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: eventing.knative.dev/v1beta1
kind: Trigger
metadata:
  name: helloaloha
spec:
  filter:
    attributes:
      type: greeting <i class="conum" data-value="1"></i><b>(1)</b>
  subscriber:
    ref:
     apiVersion: serving.knative.dev/v1
     kind: Service
     name: eventingaloha</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>type</code> is the CloudEvent type that is mapped to the <code>ce-type</code> HTTP header.  A Trigger can filter by <a href="https://cloudevents.io/">CloudEvent</a> attributes such as type, source or extension.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Run the following commands to create the trigger:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n knativetutorial -f <a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/trigger-helloaloha.yaml">trigger-helloaloha.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now create the the trigger for <code>eventingbonjour</code> that will associate the filtered events to a service:</p>
</div>
<div class="listingblock">
<div class="title"><a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/trigger-hellobonjour.yaml">trigger-hellobonjour.yaml</a></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: eventing.knative.dev/v1beta1
kind: Trigger
metadata:
  name: hellobonjour
spec:
  filter:
    attributes:
      type: greeting
  subscriber:
    ref:
     apiVersion: serving.knative.dev/v1
     kind: Service
     name: eventingbonjour</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following commands to create the trigger:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -n knativetutorial -f <a href="https://github.com/redhat-developer-demos/knative-tutorial/blob/master/eventing/trigger-hellobonjour.yaml">trigger-hellobonjour.yaml</a></code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that your triggers are ready:</p>
</div>
<div id="knative-triggers" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl --namespace knativetutorial  get triggers.eventing.knative.dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should show the following output:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME         READY BROKER  SUBSCRIBER_URI                                      AGE
helloaloha   True  default http://eventingaloha.knativetutorial.svc.cluster.local   24s
hellobonjour True  default http://eventingbonjour.knativetutorial.svc.cluster.local 48s</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="eventing-trigger-verification"><a class="anchor" href="#eventing-trigger-verification"></a>Verification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pull out the subscriberUri for <code>eventhingaloha</code>:</p>
</div>
<div id="eventing-triggers-verify-sub1" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get trigger helloaloha -o jsonpath='{.status.subscriberUri}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should show the output as:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://eventingaloha.knativetutorial.svc.cluster.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pull out the subscriberUri for <code>eventhingbonjour</code>:</p>
</div>
<div id="eventing-triggers-verify-sub2" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get trigger hellobonjour -o jsonpath='{.status.subscriberUri}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should show the output as:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://eventingbonjour.knativetutorial.svc.cluster.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>As well as broker&#8217;s subscriberUri:</p>
</div>
<div id="eventing-triggers-verify-sub3" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl get broker default -o jsonpath='{.status.address.url}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command should show the output as:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://default-broker.knativetutorial.svc.cluster.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should notice that the subscriberURIs are Kubernetes services with the suffix of <code>knativetutorial.svc.cluster.local</code>.  This means they can be interacted with from another pod within the Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>Now that you have setup the Broker and Triggers you need to send in some test messages to see the behavior.</p>
</div>
<div class="paragraph">
<p>First start streaming the logs for the event consumers:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">stern eventing -c user-container</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then create a pod for using the <code>curl</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Pod
metadata:
  labels:
    run: curler
  name: curler
spec:
  containers:
  - name: curler
    image: fedora:29 <i class="conum" data-value="1"></i><b>(1)</b>
    tty: true</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You can use any image that includes a curl command.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then exec into the <code>curler</code> pod:</p>
</div>
<div id="trigger-verify-curler" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl -n knativetutorial apply -f curler.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Exec into the <code>curler</code> pod:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl -n knativetutorial exec -it curler -- /bin/bash</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>curler</code> pod&#8217;s shell, curl the subcriberURI for eventingaloha:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v "http://eventingaloha.knativetutorial.svc.cluster.local" \
-X POST \
-H "Ce-Id: say-hello" \
-H "Ce-Specversion: 1.0" \
-H "Ce-Type: aloha" \
-H "Ce-Source: mycurl" \
-H "Content-Type: application/json" \
-d '{"key":"from a curl"}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will then see <code>eventingaloha</code> will scale-up to respond to that event:</p>
</div>
<div id="trigger-watch-aloha-scale" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command above should show the following output:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                        READY STATUS  AGE
curler                                      1/1   Running 59s
default-broker-filter-c6654bccf-vxm5m       1/1   Running 11m
default-broker-ingress-7479966dc7-pvtx6     1/1   Running 11m
eventingaloha-1-deployment-6cdc888d9d-9xnnn 2/2   Running 30s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, curl the subcriberURI for <code>eventingbonjour</code>:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v "http://eventingbonjour.knativetutorial.svc.cluster.local" \
-X POST \
-H "Ce-Id: say-hello" \
-H "Ce-Specversion: 1.0" \
-H "Ce-Type: bonjour" \
-H "Ce-Source: mycurl" \
-H "Content-Type: application/json" \
-d '{"key":"from a curl"}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>And you will see the <code>eventingbonjour</code> pod scale up:</p>
</div>
<div id="trigger-watch-eventingbonjour-scale" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command above should show the following output:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                         READY STATUS  AGE
curler                                       1/1   Running 82s
default-broker-filter-c6654bccf-vxm5m        1/1   Running 11m
default-broker-ingress-7479966dc7-pvtx6      1/1   Running 11m
eventingaloha-1-deployment-6cdc888d9d-9xnnn  2/2   Running 53s
eventingbonjour-1-deployment-fc7858b5b-s9prj 2/2   Running 5s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, trigger both <code>eventingaloha</code> and <code>eventingbonjour</code> by curling the subcriberURI for the broker:</p>
</div>
<div id="trigger-verify-trigger-all" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v "http://default-broker.knativetutorial.svc.cluster.local" \
-X POST \
-H "Ce-Id: say-hello" \
-H "Ce-Specversion: 1.0" \
-H "Ce-Type: greeting" \
-H "Ce-Source: mycurl" \
-H "Content-Type: application/json" \
-d '{"key":"from a curl"}'</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>"Ce-Type: greeting" is the key to insuring that both aloha and bonjour respond to this event</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And by watching the <strong>knativetutorial</strong> namespace, you will see both <code>eventingaloha</code> and <code>eventingbonjour</code> will come to life:</p>
</div>
<div id="trigger-watch-all-scale" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">watch kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command above should show the following output:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">NAME                                         READY STATUS  AGE
curler                                       1/1   Running 3m21s
default-broker-filter-c6654bccf-vxm5m        1/1   Running 13m
default-broker-ingress-7479966dc7-pvtx6      1/1   Running 13m
eventingaloha-1-deployment-6cdc888d9d-nlpm8  2/2   Running 6s
eventingbonjour-1-deployment-fc7858b5b-btdcr 2/2   Running 6s</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can experiment by using different type filters in the Subscription to see how the different subscribed services respond. <code>Filters</code> may use an <a href="https://cloudevents.io/">CloudEvent</a> attribute for its criteria.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="eventing-cleanup"><a class="anchor" href="#eventing-cleanup"></a>Cleanup</h2>
<div class="sectionbody">
<div id="eventing-run-trigger-broker-cleanup" class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl -n knativetutorial delete -f eventing-aloha-sink.yaml
kubectl -n knativetutorial delete -f eventing-bonjour-sink.yaml
kubectl -n knativetutorial delete -f trigger-helloaloha.yaml
kubectl -n knativetutorial delete -f trigger-hellobonjour.yaml
kubectl -n knativetutorial delete -f curler.yaml</code></pre>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
